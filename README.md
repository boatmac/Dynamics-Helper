# Dynamics Helper

A productivity tool for Technical Support Engineers (TSEs) to analyze support tickets directly from the browser using local AI.

## Features

* **Native Host Integration:** Securely communicates with a local Python backend.
* **AI Analysis:** Uses GitHub Copilot SDK to analyze error logs and ticket descriptions.
* **Privacy Focused:** No PII leaves your machine; analysis is done locally via the CLI bridge.
* **Fluent UI Support:** Automatically scrapes error context from Microsoft Dynamics interface.
* **Bookmark Manager:** Drag-and-drop support for quick access to internal tools.

## Installation

### Quick Install (User Friendly)

Open PowerShell and run:

```powershell
irm https://aka.ms/mcdyhelper | iex
```

This command downloads the latest release and runs the installer automatically.

### Manual Install

1. **Download the Release:**
    * Go to the [Releases Page](../../releases) and download the latest `.zip` file.
    * Extract the contents to a folder.

2. **Run the Installer:**
    * Double-click `install.bat`.
    * *(This wrapper script automatically bypasses PowerShell execution policies to allow the installer to run.)*

    * This will:
        * Install the Native Host and Extension to `%LOCALAPPDATA%\DynamicsHelper`.
        * Register the Native Host in the Windows Registry.
        * Restart the host if it's running.

3. **Load in Edge/Chrome:**
    * Open `chrome://extensions` or `edge://extensions`.
    * Enable **Developer Mode** (toggle in the top right).
    * Click **Load unpacked**.
    * Navigate to `%LOCALAPPDATA%\DynamicsHelper\extension` (you can paste this path into the folder selector) and select it.

### For Developers (Build from Source)

1. **Build the Extension:**

    ```bash
    cd extension
    npm install
    npm run build
    ```

2. **Install the Host:**
    * Navigate to `host/`
    * Run `install.bat` (Run as Administrator is recommended for Registry changes).
    * Ensure you have the GitHub Copilot CLI installed (`npm install -g @githubnext/github-copilot-cli`) and authenticated (`github-copilot-cli auth`).

3. **Load in Edge/Chrome:**
    * Go to `chrome://extensions`.
    * Click "Load unpacked" and select the `extension/dist` folder in this repo.
    * **Copy the Extension ID** generated by the browser.

4. **Register Host with ID:**
    * Open `host/host_manifest.json` and add your ID to `allowed_origins`.
    * Run `host/install.bat` again to update the registry keys.

## Usage

1. Open a support ticket in Dynamics or Azure Portal.
2. Click the **DH** Floating Action Button (FAB) in the bottom right.
3. Click **Analyze** to scrape the page and get an AI-generated Root Cause Analysis.
4. The result is saved as a Markdown file in your Downloads folder and displayed in a popover.

## Development

* **Frontend:** React, Vite, TypeScript, Tailwind CSS.
* **Backend:** Python 3.x, Native Messaging API, asyncio.
* **Telemetry:** Azure Application Insights (Optional).
